<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bluenet: COMP Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bluenet
   &#160;<span id="projectnumber">5.4.0</span>
   </div>
   <div id="projectbrief">Bluenet, the firmware for the Crownstone power outlet</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classCOMP-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">COMP Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The comparator is a hardware peripheral on the nRF52.  
 <a href="classCOMP.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="cs__COMP_8h_source.html">cs_COMP.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afc7fe559c2e688b41bd966a047dcf944"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCOMP.html#afc7fe559c2e688b41bd966a047dcf944">init</a> (uint8_t ainPin, float thresholdDown, float thresholdUp)</td></tr>
<tr class="memdesc:afc7fe559c2e688b41bd966a047dcf944"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="classCOMP.html" title="The comparator is a hardware peripheral on the nRF52.">COMP</a> unit gets initialized by indicating a pin.  <a href="classCOMP.html#afc7fe559c2e688b41bd966a047dcf944">More...</a><br /></td></tr>
<tr class="separator:afc7fe559c2e688b41bd966a047dcf944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a166287e3caeb8e2f86cd251511f5de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCOMP.html#a1a166287e3caeb8e2f86cd251511f5de">start</a> (CompEvent_t event)</td></tr>
<tr class="memdesc:a1a166287e3caeb8e2f86cd251511f5de"><td class="mdescLeft">&#160;</td><td class="mdescRight">The hardware peripheral is started.  <a href="classCOMP.html#a1a166287e3caeb8e2f86cd251511f5de">More...</a><br /></td></tr>
<tr class="separator:a1a166287e3caeb8e2f86cd251511f5de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafdcd65b5894d3e4948b8e0fa5e755cd"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCOMP.html#aafdcd65b5894d3e4948b8e0fa5e755cd">sample</a> ()</td></tr>
<tr class="memdesc:aafdcd65b5894d3e4948b8e0fa5e755cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a single sample which uses 1 bit of the 32 available bits.  <a href="classCOMP.html#aafdcd65b5894d3e4948b8e0fa5e755cd">More...</a><br /></td></tr>
<tr class="separator:aafdcd65b5894d3e4948b8e0fa5e755cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a394e933e074b3ddac95e0c1ec918dc83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCOMP.html#a394e933e074b3ddac95e0c1ec918dc83">setEventCallback</a> (comp_event_cb_t callback)</td></tr>
<tr class="memdesc:a394e933e074b3ddac95e0c1ec918dc83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the callback which is called on an event.  <a href="classCOMP.html#a394e933e074b3ddac95e0c1ec918dc83">More...</a><br /></td></tr>
<tr class="separator:a394e933e074b3ddac95e0c1ec918dc83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a082ad91f91dc8ba4ac47427d2f31f4ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCOMP.html#a082ad91f91dc8ba4ac47427d2f31f4ed">handleEvent</a> (nrf_comp_event_t &amp;nrf_comp_event)</td></tr>
<tr class="memdesc:a082ad91f91dc8ba4ac47427d2f31f4ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle a comparator event.  <a href="classCOMP.html#a082ad91f91dc8ba4ac47427d2f31f4ed">More...</a><br /></td></tr>
<tr class="separator:a082ad91f91dc8ba4ac47427d2f31f4ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a7e241d8915de5fc3036cd4c3310cad6f"><td class="memItemLeft" align="right" valign="top"><a id="a7e241d8915de5fc3036cd4c3310cad6f"></a>
static <a class="el" href="classCOMP.html">COMP</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCOMP.html#a7e241d8915de5fc3036cd4c3310cad6f">getInstance</a> ()</td></tr>
<tr class="memdesc:a7e241d8915de5fc3036cd4c3310cad6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use static variant of singleton, no dynamic memory allocation. <br /></td></tr>
<tr class="separator:a7e241d8915de5fc3036cd4c3310cad6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The comparator is a hardware peripheral on the nRF52. </p>
<p>It is addressed through the <a class="el" href="classCOMP.html" title="The comparator is a hardware peripheral on the nRF52.">COMP</a> HAL which is addressed through the <a class="el" href="classCOMP.html" title="The comparator is a hardware peripheral on the nRF52.">COMP</a> driver. Requires a real-time clock, the <a class="el" href="classRTC.html" title="Wrapper class for RTC functions.">RTC</a> to attach timestamps to the events.</p>
<p>TODO: Use VOLTAGE_THRESHOLD_TO_INT </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a082ad91f91dc8ba4ac47427d2f31f4ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a082ad91f91dc8ba4ac47427d2f31f4ed">&#9670;&nbsp;</a></span>handleEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void COMP::handleEvent </td>
          <td>(</td>
          <td class="paramtype">nrf_comp_event_t &amp;&#160;</td>
          <td class="paramname"><em>nrf_comp_event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle a comparator event. </p>
<p>This is automatically called on each event. In this function the event is copied and if there is an event handler set, it will be called indirectly by adding the event callback to the app scheduler.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event</td><td>Handle a particular event. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afc7fe559c2e688b41bd966a047dcf944"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc7fe559c2e688b41bd966a047dcf944">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void COMP::init </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>ainPin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>thresholdDown</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>thresholdUp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The <a class="el" href="classCOMP.html" title="The comparator is a hardware peripheral on the nRF52.">COMP</a> unit gets initialized by indicating a pin. </p>
<p>TODO: use const where appropriate TODO: use nrf_drv_comp_ain_to_gpio in implementation</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ainPin</td><td>An input pin, TODO: use pin_id_t or nrf_comp_input_t, not uint8_t </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresholdDown</td><td>Threshold to be triggered when input drops below a certain value. TODO: check. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresholdUp</td><td>Threshold to be triggered when input goes beyond a certain value. TODO: check. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aafdcd65b5894d3e4948b8e0fa5e755cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafdcd65b5894d3e4948b8e0fa5e755cd">&#9670;&nbsp;</a></span>sample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t COMP::sample </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a single sample which uses 1 bit of the 32 available bits. </p>
<p>This is: 0 if VIN+ &lt; VIN- 1 if VIN+ &gt; VIN-</p>
<dl class="section return"><dt>Returns</dt><dd>A sample from the comparator indicating relation between VIN+ and VIN-. </dd></dl>

</div>
</div>
<a id="a394e933e074b3ddac95e0c1ec918dc83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a394e933e074b3ddac95e0c1ec918dc83">&#9670;&nbsp;</a></span>setEventCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void COMP::setEventCallback </td>
          <td>(</td>
          <td class="paramtype">comp_event_cb_t&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the callback which is called on an event. </p>
<p>This callback is put in the scheduler and not executed directly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">callback</td><td>A struct with a function and parameter for that function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1a166287e3caeb8e2f86cd251511f5de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a166287e3caeb8e2f86cd251511f5de">&#9670;&nbsp;</a></span>start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void COMP::start </td>
          <td>(</td>
          <td class="paramtype">CompEvent_t&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The hardware peripheral is started. </p>
<p>First, <a class="el" href="classCOMP.html#afc7fe559c2e688b41bd966a047dcf944" title="The COMP unit gets initialized by indicating a pin.">init()</a> has to be called.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event</td><td>Start the comparator with "event" as additional configuration option. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>source/include/drivers/<a class="el" href="cs__COMP_8h_source.html">cs_COMP.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
