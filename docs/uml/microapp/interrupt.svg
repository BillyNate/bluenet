<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1327px" preserveAspectRatio="none" style="width:940px;height:1327px;" version="1.1" viewBox="0 0 940 1327" width="940px" zoomAndPan="magnify"><defs><filter height="300%" id="figdork32b9za" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#figdork32b9za)" height="141.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="156" y="267.9609"/><rect fill="#FFFFFF" filter="url(#figdork32b9za)" height="156.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="156" y="523.7578"/><rect fill="#FFFFFF" filter="url(#figdork32b9za)" height="141.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="156" y="767.6875"/><rect fill="#FFFFFF" filter="url(#figdork32b9za)" height="156.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="156" y="1023.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="52" x2="52" y1="65.2969" y2="1254.1484"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="161" x2="161" y1="65.2969" y2="1254.1484"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="262" x2="262" y1="65.2969" y2="1254.1484"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="475.5" x2="475.5" y1="65.2969" y2="1254.1484"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="665.5" x2="665.5" y1="65.2969" y2="1254.1484"/><rect fill="#FEFECE" filter="url(#figdork32b9za)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="8" y="30"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="15" y="49.9951">Scheduler</text><rect fill="#FEFECE" filter="url(#figdork32b9za)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="8" y="1253.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="15" y="1273.1436">Scheduler</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="106" y="61.9951">Microapp stack</text><path d="M143,13 C143,3 161,3 161,3 C161,3 179,3 179,13 L179,39 C179,49 161,49 161,49 C161,49 143,49 143,39 L143,13 " fill="#FEFECE" filter="url(#figdork32b9za)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M143,13 C143,23 161,23 161,23 C161,23 179,23 179,13 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="106" y="1266.1436">Microapp stack</text><path d="M143,1279.4453 C143,1269.4453 161,1269.4453 161,1269.4453 C161,1269.4453 179,1269.4453 179,1279.4453 L179,1305.4453 C179,1315.4453 161,1315.4453 161,1315.4453 C161,1315.4453 143,1315.4453 143,1305.4453 L143,1279.4453 " fill="#FEFECE" filter="url(#figdork32b9za)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M143,1279.4453 C143,1289.4453 161,1289.4453 161,1289.4453 C161,1289.4453 179,1289.4453 179,1279.4453 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#figdork32b9za)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="226" y="30"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="233" y="49.9951">Bluenet</text><rect fill="#FEFECE" filter="url(#figdork32b9za)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="226" y="1253.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="233" y="1273.1436">Bluenet</text><rect fill="#FEFECE" filter="url(#figdork32b9za)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="185" x="381.5" y="30"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="171" x="388.5" y="49.9951">Bluenet microapp thread</text><rect fill="#FEFECE" filter="url(#figdork32b9za)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="185" x="381.5" y="1253.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="171" x="388.5" y="1273.1436">Bluenet microapp thread</text><rect fill="#FEFECE" filter="url(#figdork32b9za)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="625.5" y="30"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="632.5" y="49.9951">Microapp</text><rect fill="#FEFECE" filter="url(#figdork32b9za)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="625.5" y="1253.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="632.5" y="1273.1436">Microapp</text><rect fill="#FFFFFF" filter="url(#figdork32b9za)" height="141.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="156" y="267.9609"/><rect fill="#FFFFFF" filter="url(#figdork32b9za)" height="156.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="156" y="523.7578"/><rect fill="#FFFFFF" filter="url(#figdork32b9za)" height="141.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="156" y="767.6875"/><rect fill="#FFFFFF" filter="url(#figdork32b9za)" height="156.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="156" y="1023.4844"/><rect fill="#EEEEEE" filter="url(#figdork32b9za)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="925" x="3" y="95.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="928" y1="95.8633" y2="95.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="928" y1="98.8633" y2="98.8633"/><rect fill="#EEEEEE" filter="url(#figdork32b9za)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="182" x="374.5" y="85.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="163" x="380.5" y="101.3638">Interrupt during delay</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="139.5625" y2="139.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="139.5625" y2="152.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="152.5625" y2="152.5625"/><polygon fill="#A80036" points="677,148.5625,667,152.5625,677,156.5625,673,152.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="673" y="134.4966">delay(3)</text><polygon fill="#A80036" points="487,162.5625,477,166.5625,487,170.5625,483,166.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="481" x2="665" y1="166.5625" y2="166.5625"/><polygon fill="#A80036" points="273,191.6953,263,195.6953,273,199.6953,269,195.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="267" x2="475" y1="195.6953" y2="195.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="279" y="190.6294">longjmp(bluenet)</text><polygon fill="#A80036" points="63,205.6953,53,209.6953,63,213.6953,59,209.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="57" x2="261" y1="209.6953" y2="209.6953"/><polygon fill="#A80036" points="250,234.8281,260,238.8281,250,242.8281,254,238.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="52" x2="256" y1="238.8281" y2="238.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="59" y="233.7622">tick</text><polygon fill="#A80036" points="464,263.9609,474,267.9609,464,271.9609,468,267.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="262" x2="470" y1="267.9609" y2="267.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="269" y="262.895">longjmp(microapp)</text><polygon fill="#A80036" points="654,277.9609,664,281.9609,654,285.9609,658,281.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="476" x2="660" y1="281.9609" y2="281.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="311.0938" y2="311.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="311.0938" y2="324.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="324.0938" y2="324.0938"/><polygon fill="#A80036" points="677,320.0938,667,324.0938,677,328.0938,673,324.0938" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="673" y="306.0278">no message to handle</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="353.2266" y2="353.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="353.2266" y2="366.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="366.2266" y2="366.2266"/><polygon fill="#A80036" points="677,362.2266,667,366.2266,677,370.2266,673,366.2266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="673" y="348.1606">wait for 2 more ticks</text><polygon fill="#A80036" points="487,376.2266,477,380.2266,487,384.2266,483,380.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="481" x2="665" y1="380.2266" y2="380.2266"/><polygon fill="#A80036" points="273,405.3594,263,409.3594,273,413.3594,269,409.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="267" x2="475" y1="409.3594" y2="409.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="279" y="404.2935">longjmp(bluenet)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="262" x2="304" y1="438.4922" y2="438.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="304" x2="304" y1="438.4922" y2="451.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="263" x2="304" y1="451.4922" y2="451.4922"/><polygon fill="#A80036" points="273,447.4922,263,451.4922,273,455.4922,269,451.4922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="269" y="433.4263">no command to handle</text><polygon fill="#A80036" points="63,461.4922,53,465.4922,63,469.4922,59,465.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="57" x2="261" y1="465.4922" y2="465.4922"/><polygon fill="#A80036" points="250,490.625,260,494.625,250,498.625,254,494.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="52" x2="256" y1="494.625" y2="494.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="59" y="489.5591">gpio toggle</text><polygon fill="#A80036" points="464,519.7578,474,523.7578,464,527.7578,468,523.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="262" x2="470" y1="523.7578" y2="523.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="269" y="518.6919">longjmp(microapp)</text><polygon fill="#A80036" points="654,548.8906,664,552.8906,654,556.8906,658,552.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="476" x2="660" y1="552.8906" y2="552.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="483" y="547.8247">msg: interrupt gpio toggle</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="582.0234" y2="582.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="582.0234" y2="595.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="595.0234" y2="595.0234"/><polygon fill="#A80036" points="677,591.0234,667,595.0234,677,599.0234,673,595.0234" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="673" y="576.9575">handle message: interrupt pin 5 toggle</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="624.1563" y2="624.1563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="624.1563" y2="637.1563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="637.1563" y2="637.1563"/><polygon fill="#A80036" points="677,633.1563,667,637.1563,677,641.1563,673,637.1563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="673" y="619.0903">onInterrupt(pin 5 toggle)</text><polygon fill="#A80036" points="487,647.1563,477,651.1563,487,655.1563,483,651.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="481" x2="665" y1="651.1563" y2="651.1563"/><polygon fill="#A80036" points="273,676.2891,263,680.2891,273,684.2891,269,680.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="267" x2="475" y1="680.2891" y2="680.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="279" y="675.2231">longjmp(bluenet)</text><polygon fill="#A80036" points="63,705.4219,53,709.4219,63,713.4219,59,709.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="57" x2="261" y1="709.4219" y2="709.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="69" y="704.356">return</text><polygon fill="#A80036" points="250,734.5547,260,738.5547,250,742.5547,254,738.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="52" x2="256" y1="738.5547" y2="738.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="59" y="733.4888">tick</text><polygon fill="#A80036" points="464,763.6875,474,767.6875,464,771.6875,468,767.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="262" x2="470" y1="767.6875" y2="767.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="269" y="762.6216">longjmp(microapp)</text><polygon fill="#A80036" points="654,777.6875,664,781.6875,654,785.6875,658,781.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="476" x2="660" y1="781.6875" y2="781.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="810.8203" y2="810.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="810.8203" y2="823.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="823.8203" y2="823.8203"/><polygon fill="#A80036" points="677,819.8203,667,823.8203,677,827.8203,673,823.8203" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="673" y="805.7544">no message to handle</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="852.9531" y2="852.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="852.9531" y2="865.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="865.9531" y2="865.9531"/><polygon fill="#A80036" points="677,861.9531,667,865.9531,677,869.9531,673,865.9531" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="673" y="847.8872">wait for 1 more tick</text><polygon fill="#A80036" points="487,875.9531,477,879.9531,487,883.9531,483,879.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="481" x2="665" y1="879.9531" y2="879.9531"/><polygon fill="#A80036" points="273,905.0859,263,909.0859,273,913.0859,269,909.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="267" x2="475" y1="909.0859" y2="909.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="279" y="904.02">longjmp(bluenet)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="262" x2="304" y1="938.2188" y2="938.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="304" x2="304" y1="938.2188" y2="951.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="263" x2="304" y1="951.2188" y2="951.2188"/><polygon fill="#A80036" points="273,947.2188,263,951.2188,273,955.2188,269,951.2188" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="269" y="933.1528">no command to handle</text><polygon fill="#A80036" points="63,961.2188,53,965.2188,63,969.2188,59,965.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="57" x2="261" y1="965.2188" y2="965.2188"/><polygon fill="#A80036" points="250,990.3516,260,994.3516,250,998.3516,254,994.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="52" x2="256" y1="994.3516" y2="994.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="59" y="989.2856">tick</text><polygon fill="#A80036" points="464,1019.4844,474,1023.4844,464,1027.4844,468,1023.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="262" x2="470" y1="1023.4844" y2="1023.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="269" y="1018.4185">longjmp(microapp)</text><polygon fill="#A80036" points="654,1033.4844,664,1037.4844,654,1041.4844,658,1037.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="476" x2="660" y1="1037.4844" y2="1037.4844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="1066.6172" y2="1066.6172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="1066.6172" y2="1079.6172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="1079.6172" y2="1079.6172"/><polygon fill="#A80036" points="677,1075.6172,667,1079.6172,677,1083.6172,673,1079.6172" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="673" y="1061.5513">no message to handle</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="708" y1="1108.75" y2="1108.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="708" x2="708" y1="1108.75" y2="1121.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="708" y1="1121.75" y2="1121.75"/><polygon fill="#A80036" points="677,1117.75,667,1121.75,677,1125.75,673,1121.75" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="673" y="1103.6841">}</text><polygon fill="#A80036" points="487,1146.8828,477,1150.8828,487,1154.8828,483,1150.8828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="481" x2="665" y1="1150.8828" y2="1150.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="493" y="1145.8169">msg: end of loop</text><polygon fill="#A80036" points="273,1176.0156,263,1180.0156,273,1184.0156,269,1180.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="267" x2="475" y1="1180.0156" y2="1180.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="279" y="1174.9497">longjmp(bluenet)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="262" x2="304" y1="1209.1484" y2="1209.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="304" x2="304" y1="1209.1484" y2="1222.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="263" x2="304" y1="1222.1484" y2="1222.1484"/><polygon fill="#A80036" points="273,1218.1484,263,1222.1484,273,1226.1484,269,1222.1484" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="269" y="1204.0825">handle commmand end of loop</text><polygon fill="#A80036" points="63,1232.1484,53,1236.1484,63,1240.1484,59,1236.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="57" x2="261" y1="1236.1484" y2="1236.1484"/><!--MD5=[0b843b6d6f09d73fd9ee62e38647c4c1]
@startuml

participant "Scheduler"                       as sched
database "Microapp stack"                     as appstack
participant "Bluenet"                         as fw
participant "Bluenet microapp thread"         as fw_app
participant "Microapp"                        as app

== Interrupt during delay ==
app -> app: delay(3)
app -> fw_app:
fw_app -> fw: longjmp(bluenet)
deactivate appstack
fw -> sched:

sched -> fw: tick
fw -> fw_app: longjmp(microapp)
activate appstack
fw_app -> app:
app -> app: no message to handle
app -> app: wait for 2 more ticks
app -> fw_app:
fw_app -> fw: longjmp(bluenet)
deactivate appstack
fw -> fw: no command to handle
fw -> sched:

sched -> fw: gpio toggle
fw -> fw_app: longjmp(microapp)
activate appstack
fw_app -> app: msg: interrupt gpio toggle
app -> app: handle message: interrupt pin 5 toggle
app -> app: onInterrupt(pin 5 toggle)
app -> fw_app
fw_app -> fw: longjmp(bluenet)
deactivate appstack
fw -> sched: return

sched -> fw: tick
fw -> fw_app: longjmp(microapp)
activate appstack
fw_app -> app:
app -> app: no message to handle
app -> app: wait for 1 more tick
app -> fw_app:
fw_app -> fw: longjmp(bluenet)
deactivate appstack
fw -> fw: no command to handle
fw -> sched:

sched -> fw: tick
fw -> fw_app: longjmp(microapp)
activate appstack
fw_app -> app:
app -> app: no message to handle
app -> app: }
app -> fw_app: msg: end of loop
fw_app -> fw: longjmp(bluenet)
deactivate appstack
fw -> fw: handle commmand end of loop
fw -> sched:


@enduml

PlantUML version 1.2020.00(Sat Jan 11 13:30:53 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.13+8-Ubuntu-0ubuntu1.18.04
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>