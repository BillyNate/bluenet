<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bluenet: Release process</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
	DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bluenet
   &#160;<span id="projectnumber">5.4.0</span>
   </div>
   <div id="projectbrief">Bluenet, the firmware for the Crownstone power outlet</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_RELEASE_PROCESS.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Release process </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md76"></a>
Memory usage test</h1>
<p >Perform a <a class="el" href="md_docs_MEMORY_USAGE_TEST.html">memory usage test</a>, and commit the result.</p>
<h1><a class="anchor" id="autotoc_md77"></a>
Bluenet</h1>
<p >The release process starts with updating version information. The application version has to be bumped. This is an integer that is checked by the bootloader to make sure that the application is actually newer than the previous release.</p>
<p >Update the <code>VERSION</code> file in <code>source/VERSION</code>: </p><div class="fragment"><div class="line">3.0.1</div>
<div class="line">54</div>
<div class="line">RC0</div>
</div><!-- fragment --><p> The first line is the version string in the form <code>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</code>. The second line is the integer version (used for the DFU process), and should be increased by 1 each time. The third line is empty for a release, and <code>RC&lt;int&gt;</code> for a release candidate.</p>
<p >For further instructions, we set the version in a variable:</p>
<div class="fragment"><div class="line">CS_FW_VERSION=&quot;3.0.1-RC0&quot;</div>
</div><!-- fragment --><p >Then to create a release:</p>
<div class="fragment"><div class="line">cd build</div>
<div class="line">make create_git_release</div>
</div><!-- fragment --><p >This will create a <code>release/</code> directory with the version information in a subdirectory, e.g. <code>release/crownstone_3.0.1-RC0</code>. Double check if the CMakeBuild.config is correct. Eventually add a CMakeBuild.config.overwrite file for your own passkey file. Now using this information, we will build everything for this release.</p>
<div class="fragment"><div class="line">cd build</div>
<div class="line">cmake -DCONFIG_DIR=release -DBOARD_TARGET=crownstone_${CS_FW_VERSION} -DCMAKE_BUILD_TYPE=Release -DFACTORY_IMAGE= ..</div>
<div class="line">make -j</div>
</div><!-- fragment --><p >Now we can start generating the DFU packages that will be released:</p>
<div class="fragment"><div class="line">cd crownstone_${CS_FW_VERSION}</div>
<div class="line">make build_bootloader_settings</div>
<div class="line">make generate_dfu_package_all</div>
<div class="line">make generate_dfu_package_application</div>
<div class="line">make generate_dfu_package_bootloader</div>
<div class="line">make install</div>
</div><!-- fragment --><p >After make install you will find the <code>.zip</code> files in (subdirectories of) <code>bin/crownstone_3.0.1-RC0</code>.</p>
<p >Don't forget to commit the release config:</p>
<div class="fragment"><div class="line">git add source/VERSION</div>
<div class="line">git add release/crownstone_${CS_FW_VERSION}/CMakeBuild.config</div>
<div class="line">git commit -m &quot;Added ${CS_FW_VERSION}&quot;</div>
<div class="line">git push</div>
</div><!-- fragment --><p >And create a git tag:</p>
<div class="fragment"><div class="line">git tag -a -m &quot;Tagging version ${CS_FW_VERSION}&quot; &quot;v${CS_FW_VERSION}&quot;</div>
<div class="line">git push --tags</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md78"></a>
Release repository</h1>
<p >After the above, the release <code>.zip</code> files are generated, however, they are not yet made available to the public.</p>
<p >There are two repositories that maintain releases.</p>
<ul>
<li><a href="https://github.com/crownstone/bluenet-release">https://github.com/crownstone/bluenet-release</a></li>
<li><a href="https://github.com/crownstone/bluenet-release-candidate">https://github.com/crownstone/bluenet-release-candidate</a></li>
</ul>
<p >The parent directory of the repositories is assumed to be the same as the parent directory of the bluenet repository. This can be adjusted by the CMake variables <code>RELEASE_REPOSITORY</code> and <code>RELEASE_CANDIDATE_REPOSITORY</code> in the bluenet project. Depending on the existence of RC (release candidate) version information in the <code>VERSION</code> file, the proper repository will be used. To create a release directory and fill it, call:</p>
<div class="fragment"><div class="line">cd build/crownstone_${CS_FW_VERSION}</div>
<div class="line">make create_release_in_repository</div>
</div><!-- fragment --><p >This will copy all <code>.zip</code>, <code>.elf</code>, <code>.bin</code>, files, as well as configuration files. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
